<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูพูู ูุฏุฑุช</title>
    <script src="https://cdn.tailwindcss.com"></script>
<!-- ุจุนุฏ ุงุฒ tailwind -->
<link href="https://cdn.jsdelivr.net/gh/persian-tools/persian-datepicker@latest/dist/css/persian-datepicker.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/persian-tools/persian-datepicker@latest/dist/js/persian-datepicker.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-date@latest/dist/persian-date.min.js"></script>

<!-- ููุงุด ุชุงุฑุฎ ุฌุงุฑ ุดูุณ -->
<div class="text-center mb-4">
    <div id="current-jalali-date" class="text-lg font-bold text-gray-700"></div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- ูุฏุฑ -->
    <nav class="bg-blue-600 text-white shadow-lg">
<!-- ุฏุฑ ูุณูุช ุจุงูุง ุตูุญูุ ุจุนุฏ ุงุฒ nav ุงู ฺฉุฏ ุฑุง ุงุถุงูู ฺฉูุฏ -->
<div class="container mx-auto px-4 mt-4">
    <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-4">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div class="text-center md:text-right">
                <div id="current-jalali-date" class="text-xl font-bold text-blue-800">
                    ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ุชุงุฑุฎ...
                </div>
                <div class="text-blue-600 mt-1">
                    ุณุณุชู ุจุง ุชููู ุดูุณ
                </div>
            </div>
            <div class="mt-4 md:mt-0">
                <div class="bg-white border border-blue-300 rounded-lg px-4 py-2">
                    <div class="text-sm text-gray-600">ููุชู ฺฉุงุฑ</div>
                    <div class="font-bold text-blue-700">ุดูุจู ุชุง ฺูุงุฑุดูุจู</div>
                </div>
            </div>
        </div>
    </div>
</div>
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">๐จโ๐ผ</span>
                    <div>
                        <h1 class="text-xl font-bold">ูพูู ูุฏุฑุช ุณุณุชู</h1>
                        <p class="text-sm opacity-90">ุฎูุด ุขูุฏุฏ {{ user.name }}</p>
                    </div>
                </div>
                <a href="/logout" 
                   class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg transition">
                    ุฎุฑูุฌ
                </a>
            </div>
        </div>
    </nav>

    <!-- ูุญุชูุง -->
    <div class="container mx-auto px-4 py-8">
        <!-- ุฏฺฉููโูุง ุงุตู -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <!-- ุงุฌุงุฏ ููู ููุชฺฏ -->
            <div class="bg-white rounded-xl shadow p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">๐ ุงุฌุงุฏ ููู ููุชฺฏ ุฌุฏุฏ</h2>
                <p class="text-gray-600 mb-4">ุงุฌุงุฏ ููู ุฌุฏุฏ ุจุฑุง ููุชู ุขูุฏู</p>
                <button onclick="showCreateMenuModal()"
                        class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition">
                    ๐ฝ๏ธ ุงุฌุงุฏ ููู ููุชฺฏ ุฌุฏุฏ
                </button>
            </div>
            
            <!-- ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ -->
            <div class="bg-white rounded-xl shadow p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">๐ฅ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ</h2>
                <p class="text-gray-600 mb-4">ุงูุฒูุฏู ฺฉุงุฑุจุฑ ุฌุฏุฏ ุจู ุณุณุชู</p>
                <button onclick="showCreateUserModal()"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition">
                    โ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ
                </button>
            </div>
        </div>

        <!-- ุขูุงุฑ -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow p-6">
                <div class="text-3xl font-bold text-blue-600">{{ stats.total_users }}</div>
                <div class="text-gray-600 mt-2">ฺฉุงุฑุจุฑุงู ูุนุงู</div>
            </div>
            
            <div class="bg-white rounded-xl shadow p-6">
                <div class="text-3xl font-bold text-green-600">{{ stats.total_reservations }}</div>
                <div class="text-gray-600 mt-2">ุฑุฒุฑููุง ููุชู</div>
            </div>
            
            <div class="bg-white rounded-xl shadow p-6">
                <div class="text-3xl font-bold text-purple-600">
                    {{ stats.total_company_share|int }}
                </div>
                <div class="text-gray-600 mt-2">ุณูู ุดุฑฺฉุช (ุชููุงู)</div>
            </div>
            
            <div class="bg-white rounded-xl shadow p-6">
                <div class="text-3xl font-bold text-red-600">ฑธ:ฐฐ</div>
                <div class="text-gray-600 mt-2">ูพุงุงู ูููุช</div>
            </div>
        </div>

        <!-- ุชุจโูุง ูุฏุฑุช -->
        <div class="mb-6">
            <div class="border-b border-gray-200">
                <nav class="flex space-x-8">
                    <button id="tab-users" 
                            onclick="switchTab('users')"
                            class="py-4 px-1 border-b-2 border-blue-500 font-medium text-blue-600">
                        ๐ฅ ูุฏุฑุช ฺฉุงุฑุจุฑุงู
                    </button>
                    <button id="tab-menu" 
                            onclick="switchTab('menu')"
                            class="py-4 px-1 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700">
                        ๐ฝ๏ธ ูุฏุฑุช ููู
                    </button>
                </nav>
            </div>
        </div>

        <!-- ูุญุชูุง ุชุจโูุง -->
        
        <!-- ุชุจ ฺฉุงุฑุจุฑุงู -->
        <div id="content-users">
            <div class="bg-white rounded-xl shadow mb-8">
                <div class="px-6 py-4 border-b">
                    <h2 class="text-xl font-bold text-gray-800">ฺฉุงุฑุจุฑุงู ุณุณุชู</h2>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="p-3 text-right">ูุงู</th>
                                    <th class="p-3 text-right">ุงูู</th>
                                    <th class="p-3 text-right">ุฏูพุงุฑุชูุงู</th>
                                    <th class="p-3 text-right">ููุด</th>
                                    <th class="p-3 text-right">ุนููุงุช</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for u in users %}
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="p-3">{{ u.full_name }}</td>
                                    <td class="p-3">{{ u.email }}</td>
                                    <td class="p-3">{{ u.department or '-' }}</td>
                                    <td class="p-3">
                                        {% if u.is_admin %}
                                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                                            ูุฏุฑ
                                        </span>
                                        {% else %}
                                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">
                                            ฺฉุงุฑุจุฑ
                                        </span>
                                        {% endif %}
                                    </td>
                                    <td class="p-3">
                                        <button onclick="editUser({{ u.id }})"
                                                class="text-blue-600 hover:text-blue-800 text-sm">
                                            ูุฑุงุด
                                        </button>
                                        <button onclick="resetPassword({{ u.id }})"
                                                class="text-yellow-600 hover:text-yellow-800 text-sm mr-3">
                                            ุจุงุฒูุดุงู ุฑูุฒ
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุชุจ ููู -->
        <div id="content-menu" class="hidden">
            {% if weekly_menu %}
            <div class="bg-white rounded-xl shadow mb-8">
                <div class="px-6 py-4 border-b">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">ููู ููุชู ุฌุงุฑ</h2>
                            <p class="text-gray-600 text-sm">
                                {{ weekly_menu.week_start }} ุชุง {{ weekly_menu.week_end }}
                            </p>
                        </div>
                        <button onclick="showAddFoodModal({{ weekly_menu.id }})"
                                class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                            โ ุงูุฒูุฏู ุบุฐุง
                        </button>
                    </div>
                </div>
                
                <div class="p-6">
                    <!-- ุฑูุฒูุง ููุชู -->
                    {% set days = ['ุฏูุดูุจู', 'ุณูโุดูุจู', 'ฺูุงุฑุดูุจู', 'ูพูุฌุดูุจู'] %}
                    {% for day in days %}
                    <div class="mb-8">
                        <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <span class="ml-2">๐</span>
                            {{ day }}
                            <button onclick="showAddFoodModal({{ weekly_menu.id }}, '{{ day }}')"
                                    class="text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded-lg mr-auto">
                                + ุงูุฒูุฏู ุบุฐุง
                            </button>
                        </h3>
                        
                        {% set day_foods = [] %}
                        {% for item in menu_items if item.day_of_week == day %}
                            {% set _ = day_foods.append(item) %}
                        {% endfor %}
                        
                        {% if day_foods %}
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {% for food in day_foods %}
                            <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-bold text-gray-800">{{ food.food_name }}</h4>
                                        {% if food.description %}
                                        <p class="text-sm text-gray-600 mt-1">{{ food.description }}</p>
                                        {% endif %}
                                        <div class="mt-2 space-y-1">
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">ููุช ฺฉุงูู:</span>
                                                <span class="font-bold">{{ food.full_price|int }} ุชููุงู</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">ุณูู ฺฉุงุฑุจุฑ:</span>
                                                <span class="font-bold text-green-600">{{ food.user_price|int }} ุชููุงู</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">ุณูู ุดุฑฺฉุช:</span>
                                                <span class="text-blue-600">{{ food.company_share|int }} ุชููุงู</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">ุธุฑูุช:</span>
                                                <span class="{% if food.reserved_count >= food.capacity %}text-red-600{% else %}text-gray-700{% endif %}">
                                                    {{ food.reserved_count }}/{{ food.capacity }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex flex-col space-y-2">
                                        <button onclick="editFood({{ food.id }})"
                                                class="text-blue-600 hover:text-blue-800 text-sm">
                                            ูุฑุงุด
                                        </button>
                                        <button onclick="deleteFood({{ food.id }})"
                                                class="text-red-600 hover:text-red-800 text-sm">
                                            ุญุฐู
                                        </button>
                                        {% if food.extra_food %}
                                        <span class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">
                                            ุบุฐุง ุงุถุงู
                                        </span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="text-center py-8 border border-dashed border-gray-300 rounded-lg">
                            <p class="text-gray-500">ูููุฒ ุบุฐุง ุจุฑุง ุงู ุฑูุฒ ุงุถุงูู ูุดุฏู ุงุณุช.</p>
                            <button onclick="showAddFoodModal({{ weekly_menu.id }}, '{{ day }}')"
                                    class="mt-2 text-blue-600 hover:text-blue-800">
                                ฺฉูฺฉ ฺฉูุฏ ุจุฑุง ุงูุฒูุฏู ุบุฐุง
                            </button>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% else %}
            <div class="bg-white rounded-xl shadow p-8 text-center">
                <div class="text-5xl mb-4 text-gray-300">๐ฝ๏ธ</div>
                <h3 class="text-xl font-bold text-gray-700 mb-2">ููู ููุชู ุฌุงุฑ ูุฌูุฏ ูุฏุงุฑุฏ</h3>
                <p class="text-gray-600 mb-6">ุจุฑุง ุดุฑูุนุ ฺฉ ููู ููุชฺฏ ุฌุฏุฏ ุงุฌุงุฏ ฺฉูุฏ.</p>
                <button onclick="showCreateMenuModal()"
                        class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg">
                    ุงุฌุงุฏ ููู ููุชู ุฌุฏุฏ
                </button>
            </div>
            {% endif %}
        </div>
    </div>

   <!-- ููุฏุงู ุงุฌุงุฏ ููู ููุชฺฏ -->
<div id="createMenuModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-bold text-gray-800">๐ ุงุฌุงุฏ ููู ููุชฺฏ ุฌุฏุฏ (ุดูุณ)</h3>
        </div>
        
        <div class="p-6">
            <form id="createMenuForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-700 mb-2">ุชุงุฑุฎ ุดุฑูุน ููุชู (ุดูุจู) *</label>
                        <div class="datepicker-container">
                            <input type="text" id="week_start" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg datepicker-input"
                                   placeholder="1402/10/01" readonly>
                            <input type="hidden" name="week_start" id="week_start_gregorian">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">ุชุงุฑุฎ ูพุงุงู ููุชู (ฺูุงุฑุดูุจู) *</label>
                        <div class="datepicker-container">
                            <input type="text" id="week_end" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg datepicker-input"
                                   placeholder="1402/10/05" readonly>
                            <input type="hidden" name="week_end" id="week_end_gregorian">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">ูููุช ุฑุฒุฑู (ฺูุงุฑุดูุจู ฑธ:ฐฐ) *</label>
                        <div class="datepicker-container">
                            <input type="text" id="reservation_deadline" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg datepicker-input"
                                   placeholder="1402/10/05 ฑธ:ฐฐ" readonly>
                            <input type="hidden" name="reservation_deadline" id="reservation_deadline_gregorian">
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end space-x-4">
                    <button type="button" onclick="hideModal('createMenuModal')" 
                            class="px-4 py-2 border border-gray-300 rounded-lg">
                        ุงูุตุฑุงู
                    </button>
                    <button type="submit" 
                            class="bg-green-600 text-white px-4 py-2 rounded-lg">
                        ุงุฌุงุฏ ููู
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

    <!-- ููุฏุงู ุงุฌุงุฏ ฺฉุงุฑุจุฑ -->
    <div id="createUserModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-gray-800">๐ฅ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ</h3>
            </div>
            
            <div class="p-6">
                <form id="createUserForm">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ุดูุงุฑู ูพุฑุณูู *</label>
                            <input type="text" name="employee_id" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="EMP001">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ูุงู ฺฉุงูู *</label>
                            <input type="text" name="full_name" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="ุฑุถุง ูุญูุฏ">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ุงูู *</label>
                            <input type="email" name="email" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="example@company.com">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ุฑูุฒ ุนุจูุฑ *</label>
                            <input type="password" name="password" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="ุญุฏุงูู ธ ฺฉุงุฑุงฺฉุชุฑ">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ุฏูพุงุฑุชูุงู</label>
                            <select name="department" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                                <option value="ูุฑูุด">ูุฑูุด</option>
                                <option value="ูุงู">ูุงู</option>
                                <option value="ูพุดุชุจุงู">ูพุดุชุจุงู</option>
                                <option value="ุชููุฏ">ุชููุฏ</option>
                                <option value="IT">IT</option>
                                <option value="ูุฏุฑุช">ูุฏุฑุช</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" name="is_admin" id="is_admin" 
                                   class="ml-2 h-4 w-4 text-blue-600 border-gray-300 rounded">
                            <label for="is_admin" class="text-gray-700">ุฏุณุชุฑุณ ูุฏุฑ ุณุณุชู</label>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end space-x-4">
                        <button type="button" onclick="hideModal('createUserModal')" 
                                class="px-4 py-2 border border-gray-300 rounded-lg">
                            ุงูุตุฑุงู
                        </button>
                        <button type="submit" 
                                class="bg-blue-600 text-white px-4 py-2 rounded-lg">
                            ุงุฌุงุฏ ฺฉุงุฑุจุฑ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ููุฏุงู ุงูุฒูุฏู ุบุฐุง -->
    <div id="addFoodModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-gray-800">๐ฝ๏ธ ุงูุฒูุฏู ุบุฐุง ุจู ููู</h3>
            </div>
            
            <div class="p-6">
                <form id="addFoodForm">
                    <input type="hidden" name="weekly_menu_id" id="food_weekly_menu_id">
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ุฑูุฒ ููุชู *</label>
                            <select name="day_of_week" required 
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg" id="food_day_of_week">
                                <option value="ุฏูุดูุจู">ุฏูุดูุจู</option>
                                <option value="ุณูโุดูุจู">ุณูโุดูุจู</option>
                                <option value="ฺูุงุฑุดูุจู">ฺูุงุฑุดูุจู</option>
                                <option value="ูพูุฌุดูุจู">ูพูุฌุดูุจู</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ูุงู ุบุฐุง *</label>
                            <input type="text" name="food_name" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="ูุซูุงู: ููู ุจุงุฏูุฌุงู">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ุชูุถุญุงุช</label>
                            <textarea name="description" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                      rows="2" placeholder="ุชูุถุญุงุช ุบุฐุง"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ููุช ฺฉุงูู (ุชููุงู) *</label>
                            <input type="number" name="full_price" required min="1000" step="1000"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="50000">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 mb-2">ุธุฑูุช *</label>
                            <input type="number" name="capacity" required min="1"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="50">
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" name="extra_food" id="extra_food" 
                                   class="ml-2 h-4 w-4 text-purple-600 border-gray-300 rounded"
                                   onchange="toggleExtraFoodPrice()">
                            <label for="extra_food" class="text-gray-700">ุบุฐุง ุงุถุงู</label>
                        </div>
                        
                        <div id="extra_food_price_container" class="hidden">
                            <label class="block text-gray-700 mb-2">ููุช ุบุฐุง ุงุถุงู (ุชููุงู)</label>
                            <input type="number" name="extra_food_price" min="1000" step="1000"
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                   placeholder="ููุช ฺฉุงูู ุจุฑุง ุบุฐุง ุงุถุงู">
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end space-x-4">
                        <button type="button" onclick="hideModal('addFoodModal')" 
                                class="px-4 py-2 border border-gray-300 rounded-lg">
                            ุงูุตุฑุงู
                        </button>
                        <button type="submit" 
                                class="bg-green-600 text-white px-4 py-2 rounded-lg">
                            ุงูุฒูุฏู ุบุฐุง
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // ูุฏุฑุช ุชุจโูุง
        function switchTab(tabName) {
            // ุจูโุฑูุฒุฑุณุงู ุชุจโูุง
            ['users', 'menu'].forEach(tab => {
                const tabBtn = document.getElementById(`tab-${tab}`);
                const content = document.getElementById(`content-${tab}`);
                
                if (tab === tabName) {
                    tabBtn.classList.remove('border-transparent', 'text-gray-500');
                    tabBtn.classList.add('border-blue-500', 'text-blue-600');
                    content.classList.remove('hidden');
                } else {
                    tabBtn.classList.remove('border-blue-500', 'text-blue-600');
                    tabBtn.classList.add('border-transparent', 'text-gray-500');
                    content.classList.add('hidden');
                }
            });
        }
        
        // ูุฏุฑุช ููุฏุงูโูุง
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('flex');
            document.getElementById(modalId).classList.add('hidden');
        }
        
        function showCreateMenuModal() {
            showModal('createMenuModal');
        }
        
        function showCreateUserModal() {
            showModal('createUserModal');
        }
        
        function showAddFoodModal(weeklyMenuId = null, dayOfWeek = null) {
            if (weeklyMenuId) {
                document.getElementById('food_weekly_menu_id').value = weeklyMenuId;
            }
            if (dayOfWeek) {
                document.getElementById('food_day_of_week').value = dayOfWeek;
            }
            showModal('addFoodModal');
        }
        
        // ฺฉูุชุฑู ุบุฐุง ุงุถุงู
        function toggleExtraFoodPrice() {
            const container = document.getElementById('extra_food_price_container');
            const checkbox = document.getElementById('extra_food');
            
            if (checkbox.checked) {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }
        
        // ุงุฑุณุงู ูุฑู ุงุฌุงุฏ ููู
        document.getElementById('createMenuForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            try {
                const response = await axios.post('/api/create_weekly_menu', data);
                
                if (response.data.success) {
                    alert(response.data.message);
                    hideModal('createMenuModal');
                    location.reload();
                } else {
                    alert('ุฎุทุง: ' + response.data.message);
                }
            } catch (error) {
                alert('ุฎุทุง ุฏุฑ ุงุฑุชุจุงุท ุจุง ุณุฑูุฑ');
                console.error(error);
            }
        });
        
        // ุงุฑุณุงู ูุฑู ุงุฌุงุฏ ฺฉุงุฑุจุฑ
        document.getElementById('createUserForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            data.is_admin = document.getElementById('is_admin').checked;
            
            try {
                const response = await axios.post('/api/create_user', data);
                
                if (response.data.success) {
                    alert(response.data.message);
                    hideModal('createUserModal');
                    location.reload();
                } else {
                    alert('ุฎุทุง: ' + response.data.message);
                }
            } catch (error) {
                alert('ุฎุทุง ุฏุฑ ุงุฑุชุจุงุท ุจุง ุณุฑูุฑ');
                console.error(error);
            }
        });
        
        // ุงุฑุณุงู ูุฑู ุงูุฒูุฏู ุบุฐุง
        document.getElementById('addFoodForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            data.extra_food = document.getElementById('extra_food').checked;
            
            // ุชุจุฏู ุงุนุฏุงุฏ
            data.full_price = parseFloat(data.full_price);
            data.capacity = parseInt(data.capacity);
            if (data.extra_food_price) {
                data.extra_food_price = parseFloat(data.extra_food_price);
            }
            
            try {
                const response = await axios.post('/api/add_menu_item', data);
                
                if (response.data.success) {
                    alert(response.data.message);
                    hideModal('addFoodModal');
                    location.reload();
                } else {
                    alert('ุฎุทุง: ' + response.data.message);
                }
            } catch (error) {
                alert('ุฎุทุง ุฏุฑ ุงุฑุชุจุงุท ุจุง ุณุฑูุฑ');
                console.error(error);
            }
        });
        
        // ุณุงุฑ ุชูุงุจุน
        function editUser(userId) {
            alert('ูุฑุงุด ฺฉุงุฑุจุฑ ุจุง ID: ' + userId + '\nุงู ูฺฺฏ ุฏุฑ ูุณุฎู ุจุนุฏ ุงุถุงูู ุฎูุงูุฏ ุดุฏ.');
        }
        
        function resetPassword(userId) {
            if (confirm('ุขุง ูโุฎูุงูุฏ ุฑูุฒ ุนุจูุฑ ุงู ฺฉุงุฑุจุฑ ุฑุง ุจุงุฒูุดุงู ฺฉูุฏุ')) {
                alert('ุฑูุฒ ุนุจูุฑ ุจุงุฒูุดุงู ุดุฏ (ุฑูุฒ ุฌุฏุฏ: User@123!)');
                // ุฏุฑ ูุณุฎู ุจุนุฏ ูพุงุฏูโุณุงุฒ ูโุดูุฏ
            }
        }
        
        function editFood(foodId) {
            alert('ูุฑุงุด ุบุฐุง ุจุง ID: ' + foodId + '\nุงู ูฺฺฏ ุฏุฑ ูุณุฎู ุจุนุฏ ุงุถุงูู ุฎูุงูุฏ ุดุฏ.');
        }
        
        function deleteFood(foodId) {
            if (confirm('ุขุง ุงุฒ ุญุฐู ุงู ุบุฐุง ูุทูุฆู ูุณุชุฏุ')) {
                alert('ุบุฐุง ุญุฐู ุดุฏ');
                // ุฏุฑ ูุณุฎู ุจุนุฏ ูพุงุฏูโุณุงุฒ ูโุดูุฏ
            }
        }
        
        // ุจุงุฑฺฏุฐุงุฑ ุงููู
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('users');
        });
    </script>
// ุฏุฑ ุงูุชูุง admin_simple.html ูุจู ุงุฒ </body> ุงุถุงูู ฺฉูุฏ
<script>
    // ููุงุด ุชุงุฑุฎ ุดูุณ ุฌุงุฑ
    function showCurrentJalaliDate() {
        // ุฑูุฒูุง ููุชู ุจู ูุงุฑุณ
        const days = ['ุดูุจู', 'ฺฉุดูุจู', 'ุฏูุดูุจู', 'ุณูโุดูุจู', 'ฺูุงุฑุดูุจู', 'ูพูุฌุดูุจู', 'ุฌูุนู'];
        
        // ูุงูโูุง ุดูุณ
        const months = [
            'ูุฑูุฑุฏู', 'ุงุฑุฏุจูุดุช', 'ุฎุฑุฏุงุฏ', 'ุชุฑ', 'ูุฑุฏุงุฏ', 'ุดูุฑูุฑ',
            'ููุฑ', 'ุขุจุงู', 'ุขุฐุฑ', 'ุฏ', 'ุจููู', 'ุงุณููุฏ'
        ];
        
        // ุชุงุฑุฎ ุฌุงุฑ ููุงุฏ
        const now = new Date();
        
        // ุงูฺฏูุฑุชู ุชุจุฏู ููุงุฏ ุจู ุดูุณ
        const gy = now.getFullYear();
        const gm = now.getMonth() + 1;
        const gd = now.getDate();
        
        // ุชุจุฏู ุจู ุดูุณ
        const g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
        let jy;
        if (gy > 1600) {
            jy = 979;
            gy -= 1600;
        } else {
            jy = 0;
            gy -= 621;
        }
        
        let gy2 = (gm > 2) ? (gy + 1) : gy;
        let days = (365 * gy) + (parseInt((gy2 + 3) / 4)) - (parseInt((gy2 + 99) / 100)) + 
                   (parseInt((gy2 + 399) / 400)) - 80 + gd + g_d_m[gm - 1];
        jy += 33 * parseInt(days / 12053);
        days %= 12053;
        jy += 4 * parseInt(days / 1461);
        days %= 1461;
        
        if (days > 365) {
            jy += parseInt((days - 1) / 365);
            days = (days - 1) % 365;
        }
        
        let jm, jd;
        if (days < 186) {
            jm = 1 + parseInt(days / 31);
            jd = 1 + (days % 31);
        } else {
            jm = 7 + parseInt((days - 186) / 30);
            jd = 1 + ((days - 186) % 30);
        }
        
        // ูุงู ุฑูุฒ ููุชู
        const dayOfWeek = now.getDay(); // 0=ฺฉุดูุจู, 1=ุฏูุดูุจู, ..., 6=ุดูุจู
        // ุชุทุจู ุจุง ุณุณุชู ุดูุณ (ุดูุจู=0)
        const jalaliDayOfWeek = (dayOfWeek + 1) % 7;
        const dayName = days[jalaliDayOfWeek];
        
        // ูุงู ูุงู
        const monthName = months[jm - 1];
        
        // ููุงุด ุฏุฑ ุตูุญู
        const element = document.getElementById('current-jalali-date');
        if (element) {
            element.textContent = `${dayName}ุ ${jd} ${monthName} ${jy}`;
        }
    }
    
    // ุชุจุฏู ุชุงุฑุฎ ููุงุฏ ุจู ุดูุณ ุจุฑุง ููุงุด
    function formatJalaliDate(dateStr) {
        if (!dateStr) return '';
        
        try {
            // ุงฺฏุฑ ุชุงุฑุฎ ุดุงูู ุฒูุงู ุงุณุช
            const datePart = dateStr.split(' ')[0];
            const [year, month, day] = datePart.split('-').map(Number);
            
            const date = new Date(year, month - 1, day);
            return gregorianToJalali(date);
        } catch (e) {
            return dateStr;
        }
    }
    
    // ุชุจุฏู ููุงุฏ ุจู ุดูุณ
    function gregorianToJalali(gregorianDate) {
        const gd = gregorianDate.getDate();
        const gm = gregorianDate.getMonth() + 1;
        const gy = gregorianDate.getFullYear();
        
        const g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
        let jy;
        if (gy > 1600) {
            jy = 979;
            gy -= 1600;
        } else {
            jy = 0;
            gy -= 621;
        }
        
        let gy2 = (gm > 2) ? (gy + 1) : gy;
        let days = (365 * gy) + (parseInt((gy2 + 3) / 4)) - (parseInt((gy2 + 99) / 100)) + 
                   (parseInt((gy2 + 399) / 400)) - 80 + gd + g_d_m[gm - 1];
        jy += 33 * parseInt(days / 12053);
        days %= 12053;
        jy += 4 * parseInt(days / 1461);
        days %= 1461;
        
        if (days > 365) {
            jy += parseInt((days - 1) / 365);
            days = (days - 1) % 365;
        }
        
        let jm, jd;
        if (days < 186) {
            jm = 1 + parseInt(days / 31);
            jd = 1 + (days % 31);
        } else {
            jm = 7 + parseInt((days - 186) / 30);
            jd = 1 + ((days - 186) % 30);
        }
        
        return `${jy}/${jm.toString().padStart(2, '0')}/${jd.toString().padStart(2, '0')}`;
    }
    
    // ููุช ุตูุญู ููุฏ ุดุฏ
    document.addEventListener('DOMContentLoaded', function() {
        // ููุงุด ุชุงุฑุฎ ุฌุงุฑ
        showCurrentJalaliDate();
        
        // ุจูโุฑูุฒุฑุณุงู ุชุงุฑุฎ ูุฑ ุฏููู
        setInterval(showCurrentJalaliDate, 60000);
        
        // ุชุจุฏู ุชุงุฑุฎโูุง ููุฌูุฏ ุฏุฑ ุตูุญู ุจู ุดูุณ
        convertPageDatesToJalali();
    });
    
    // ุชุจุฏู ุชูุงู ุชุงุฑุฎโูุง ุตูุญู ุจู ุดูุณ
    function convertPageDatesToJalali() {
        // ุชุงุฑุฎโูุง ููู
        const dateElements = document.querySelectorAll('[data-gregorian-date]');
        dateElements.forEach(element => {
            const gregorianDate = element.getAttribute('data-gregorian-date');
            const jalaliDate = formatJalaliDate(gregorianDate);
            if (jalaliDate) {
                element.textContent = jalaliDate;
            }
        });
    }
</script>
</body>
</html>
